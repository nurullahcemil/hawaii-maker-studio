{% comment %}
  Local Business Schema Snippet
  Uses settings from Schema & SEO Settings section
{% endcomment %}

{% if settings.enable_local_business_schema %}
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "{{ settings.business_type | default: 'Store' }}",
  "name": {{ settings.business_name | default: shop.name | json }},
  "description": {{ settings.business_description | default: shop.description | json }},
  "url": {{ shop.url | json }},
  {% if settings.logo %}
    "logo": {{ settings.logo | image_url: width: 600 | prepend: "https:" | json }},
  {% endif %}
  {% if settings.business_phone != blank %}
    "telephone": {{ settings.business_phone | json }},
  {% endif %}
  {% if settings.business_email != blank %}
    "email": {{ settings.business_email | json }},
  {% endif %}
  {% if settings.business_address_street != blank %}
    "address": {
      "@type": "PostalAddress",
      "streetAddress": {{ settings.business_address_street | json }},
      "addressLocality": {{ settings.business_address_city | json }},
      "addressRegion": {{ settings.business_address_state | json }},
      "postalCode": {{ settings.business_address_zip | json }},
      "addressCountry": {{ settings.business_address_country | default: "United States" | json }}
    },
  {% endif %}
  {% if settings.business_hours != blank %}
    "openingHours": {{ settings.business_hours | json }},
  {% endif %}
  {% assign social_urls = '' %}
  {% if settings.social_facebook != blank %}
    {% assign social_urls = social_urls | append: '"' | append: settings.social_facebook | append: '"' %}
  {% endif %}
  {% if settings.social_instagram != blank %}
    {% if social_urls != blank %}{% assign social_urls = social_urls | append: ',' %}{% endif %}
    {% assign social_urls = social_urls | append: '"' | append: settings.social_instagram | append: '"' %}
  {% endif %}
  {% if settings.social_youtube != blank %}
    {% if social_urls != blank %}{% assign social_urls = social_urls | append: ',' %}{% endif %}
    {% assign social_urls = social_urls | append: '"' | append: settings.social_youtube | append: '"' %}
  {% endif %}
  {% if settings.social_tiktok != blank %}
    {% if social_urls != blank %}{% assign social_urls = social_urls | append: ',' %}{% endif %}
    {% assign social_urls = social_urls | append: '"' | append: settings.social_tiktok | append: '"' %}
  {% endif %}
  {% if social_urls != blank %}
    "sameAs": [{{ social_urls }}],
  {% endif %}
  "priceRange": "$",
  "currenciesAccepted": "{{ cart.currency.iso_code }}",
  "paymentAccepted": "Credit Card, PayPal"
}
</script>
{% endif %}

{% if settings.schema_debug_mode %}
<script>
console.log('Local Business Schema enabled:', {{ settings.enable_local_business_schema | json }});
console.log('Business Type:', {{ settings.business_type | json }});
</script>
{% endif %}
